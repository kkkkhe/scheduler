import{combine as e,createEvent as r,is as n,withRegion as t,createStore as o,sample as a,guard as i,merge as c,split as u,createEffect as s,attach as d,createNode as f,step as l,clearNode as m,forward as p,restore as v}from"effector";function g(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return e({and:[n,e=>{for(var r of e)if(!r)return!1;return!0}],or:{sid:"-rbm5ks"}})}function y(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function h(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,r||"default");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==typeof r?r:String(r)}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function b(e){var{events:u,reset:s,target:d=r({name:"target",sid:"aip3nf"},{name:"target",sid:"aip3nf"})}=e;return n.unit(d)||w("target should be a unit"),s&&!n.unit(s)&&w("reset should be a unit"),t(d,(()=>{var e=Object.keys(u),r=Array.isArray(u)?[...e].fill(""):{},n=o(e.length,{and:{serialize:"ignore"},name:"$counter",sid:"-dby0v3"}),t=o(r,{and:{serialize:"ignore"},name:"$results",sid:"c60qbe"});n.reset(a({and:[{source:d}],or:{sid:"-8hxq8z"}})),t.reset(d),s&&(n.reset(a({and:[{source:s}],or:{sid:"3c6u5p"}})),t.reset(s));var f=function(e){var r=o(!1,{and:{serialize:"ignore"},name:"$isDone",sid:"uttu1j"}).on(u[e],(()=>!0)).reset(d);s&&r.reset(s),n.on(r,(e=>e-1)),t.on(u[e],((r,n)=>{var t=Array.isArray(r)?[...r]:function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?y(Object(n),!0).forEach((function(r){h(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}({},r);return t[e]=n,t}))};for(var l of e)f(l);i({and:[{source:a({and:[{source:t,clock:c(Object.values(u),{name:"clock",sid:"-531esq"})}],or:{name:"source",sid:"uwap9g"}}),filter:n.map((e=>0===e)),target:d}],or:{sid:"ciyd7d"}})})),d}function w(e){throw new Error(e)}function k(e){var{if:t,then:o,else:a,source:c=r({name:"source",sid:"epke23"},{name:"source",sid:"epke23"})}=e,s=n.unit(t)||"function"==typeof t?t:e=>e===t;return o&&a?u({and:[{source:c,match:{then:s,else:j(s)},cases:{then:o,else:a}}],or:{sid:"9tug3k"}}):o?i({and:[{source:c,filter:s,target:o}],or:{sid:"abznoh"}}):a&&i({and:[{source:c,filter:j(s),target:a}],or:{sid:"-eb29qp"}}),c}function j(e){return n.unit(e)?e.map((e=>!e)):r=>!e(r)}function O(e){var{source:t,timeout:u,target:f}=e;if(!n.unit(t))throw new TypeError("source must be unit from effector");if(n.domain(t,{sid:"k76nst"}))throw new TypeError("source cannot be domain");var l=function(e){if(n.store(e,{sid:"-mlqvq"}))return e;if("number"==typeof e){if(e<0||!Number.isFinite(e))throw new Error('timeout must be positive number or zero. Received: "'.concat(e,'"'));return o(e,{and:{name:"$timeout"},sid:"-6oihcx"})}throw new TypeError('timeout parameter in interval method should be number or Store. "'.concat(typeof e,'" was passed'))}(u),m=r({name:"saveTimeoutId",sid:"vsg63k"}),p=o(null,{and:{serialize:"ignore"},name:"$timeoutId",sid:"lhz3ie"}).on(m,((e,r)=>r)),v=r({name:"saveReject",sid:"qddkx3"}),g=o(null,{and:{serialize:"ignore"},name:"$rejecter",sid:"-o8m8p2"}).on(v,((e,r)=>r)),y=null!=f?f:r({name:"tick",sid:"a51tok"}),h=s((e=>{var{timeout:r,timeoutId:n,rejectPromise:t}=e;return n&&clearTimeout(n),t&&t(),new Promise(((e,n)=>{v(n),m(setTimeout(e,r))}))}),{name:"timerBaseFx",sid:"-6dos97"}),b=d({and:{source:{timeoutId:p,rejectPromise:g},mapParams:(e,r)=>{var{timeoutId:n,rejectPromise:t}=r;return{timeout:e,timeoutId:n,rejectPromise:t}},effect:h},or:{name:"timerFx",sid:"ca9mop"}});g.reset(b.done),p.reset(b.done);var w=o([],{and:{serialize:"ignore"},name:"$payload",sid:"jthvlw"}).on(t,((e,r)=>[r])),k=o(!0,{and:{serialize:"ignore"},name:"$canTick",sid:"-rehy9s"}),j=r({name:"triggerTick",sid:"31ed0l"});k.on(j,(()=>!1)).on([y,l,b],(()=>!0));var O=c([t,l],{name:"requestTick",sid:"7xoh8q"});return i({and:[{clock:O,filter:k,target:j}],or:{sid:"-1mcdjn"}}),a({and:[{source:l,clock:j,target:b}],or:{sid:"-1j1lzh"}}),a({and:[{source:w,clock:b.done,fn:e=>{var[r]=e;return r},target:y}],or:{sid:"-1475yq"}}),y}function E(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function P(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?E(Object(n),!0).forEach((function(r){T(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function T(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,r||"default");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==typeof r?r:String(r)}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}var S={trace:!1,handler:e=>{if(!K(e.node)||"finally"!==e.node.meta.named){var{scope:r,scopeName:n,name:t,kind:o,value:a,loc:i,trace:c,node:u,logType:s}=e,d=r?" (scope: ".concat(n,")"):"",f=null!=t?t:i?"".concat(i.file,":").concat(i.line,":").concat(i.column):"",l="initial"===s?" [getState]":"";console.info("[".concat(o,"]").concat(d," ").concat(f).concat(l),a),c&&c.length>0&&!K(u)&&(console.groupCollapsed("[".concat(o,"]").concat(d," ").concat(f," trace")),c.forEach((e=>{var{name:r,kind:n,value:t,loc:o}=e,a=null!=r?r:o?"".concat(o.file,":").concat(o.line,":").concat(o.column):"";console.info("<- [".concat(n,"] ").concat(a),t)})),console.groupEnd())}}};function z(){var{config:e,units:r}=D(...arguments);r.forEach((r=>{n.store(r,{sid:"-foynff"})||n.event(r,{sid:"apy28p"})||n.effect(r,{sid:"apy3od"})?$(r,e):n.domain(r,{sid:"-rsqe9t"})&&A(r,e)}))}function A(e,r){e.onCreateStore((e=>$(e,r))),e.onCreateEvent((e=>$(e,r))),e.onCreateEffect((e=>$(e,r))),e.onCreateDomain((e=>A(e,r)))}function $(e,r){n.store(e,{sid:"w7ds2s"})?(!function(e,r){if(!r.handler)throw Error("patronum/debug must have the handler");var n={logType:"initial",scope:null,scopeName:null,node:U(e),kind:V(e),value:e.getState(),name:J(e),loc:Q(e),trace:[],stackMeta:{}};r.handler(n),_.forEach((n=>N(e,r,n))),C((n=>N(e,r,n)))}(e,r),q(e,r)):n.event(e,{sid:"fretyd"})?q(e,r):n.effect(e,{sid:"gpi2qr"})&&(q(e,r),q(e.finally,r),q(e.done,r),q(e.fail,r))}function q(e,r){var n=f({parent:[e],meta:{op:"watch"},family:{owners:e},regional:!0,node:[l.run({fn(n,t,o){var a,i=null!==(a=null==o?void 0:o.scope)&&void 0!==a?a:null,c={logType:"update",scope:i,scopeName:B(i),node:U(e),kind:V(e),value:n,name:J(e),loc:Q(e),stackMeta:W(o.parent),trace:r.trace?x(o):[]};if(!r.handler)throw Error("patronum/debug must have the handler");r.handler(c)}})]});return()=>m(n)}function x(e){for(var r=[],n=null==e?void 0:e.parent;n;){var{node:t,value:o}=n,a={node:t,value:o,name:J(t),loc:Q(t),kind:V(t),stackMeta:W(n)};r.push(a),n=n.parent}return r}function N(e,r,n){if(!r.handler)throw Error("patronum/debug must have the handler");var t=U(e),o={logType:"initial",scope:n,scopeName:B(n),node:t,kind:V(e),value:n.getState(e),name:J(e),loc:Q(e),trace:[],stackMeta:{}};r.handler(o)}function D(){for(var e=S,r=arguments.length,t=new Array(r),o=0;o<r;o++)t[o]=arguments[o];var[a,...i]=t,c=[];if(I(a))e=P(P({},S),a);else if(n.unit(a))c.push(a);else for(var[u,s]of Object.entries(a))H.set(G(s).id,u),c.push(s);for(var d of i)if(n.unit(d))c.push(d);else for(var[f,l]of Object.entries(d))H.set(G(l).id,f),c.push(l);return{config:e,units:c}}function I(e){return!n.unit(e)&&!Object.values(e).every(n.unit)}var F=new Set,C=e=>(F.add(e),()=>{F.delete(e)});var M=0;var R=new Map,_={save(e,r){_.get(e)||R.set(e,r)},get(e){var r;return e&&null!==(r=R.get(e))&&void 0!==r?r:null},delete(e){R.delete(e)},forEach(e){R.forEach(((r,n)=>e(n,r)))},clear(){R.clear()}};function B(e){if(!e)return null;var r=_.get(e);return r?r.name:e._debugId||(e._debugId="unknown_".concat(M+=1))}function K(e){var r=U(e),{sid:n,named:t}=r.meta;return Boolean(!n&&("finally"===t||"done"===t||"doneData"===t||"fail"===t||"failData"===t||"inFlight"===t||"pending"===t))}function V(e){if(n.store(e,{sid:"4o7s04"}))return"store";if(n.effect(e,{sid:"4pv5s7"})||K(e))return"effect";if(n.event(e,{sid:"4rijka"}))return"event";if(n.domain(e,{sid:"54plsy"}))return"domain";if(n.unit(e))return"unit";var r=U(e);return r.meta.op?r.meta.op:"unknown"}z.registerScope=function(e,r){return _.save(e,{name:r.name}),F.forEach((r=>r(e))),()=>{_.delete(e)}},z.unregisterAllScopes=function(){_.clear()};var G=e=>e.graphite||e,H=new Map;function J(e){var r,t,o=H.get(G(e).id);if(o)return o;if(K(e)){var a=U(e),i=a.family.owners.find((e=>"effect"===e.meta.op));if(i){var c=L(i),u=c?"".concat(c,"/"):"";return"".concat(u).concat(J(i),".").concat(a.meta.named)}return a.meta.named}if(function(e){var r=U(e),{op:n}=r.meta;return"on"===n}(e)){var s=U(e),d=J(s.next[0]),f=J(s.family.owners[0]);return"".concat(d,".on(").concat(f,")")}if(n.unit(e)){var l;if(null!=e&&null!==(l=e.compositeName)&&void 0!==l&&l.fullName)return e.compositeName.fullName;var m=L(e),p=m?"".concat(m,"/"):"";if(null!=e&&e.shortName)return"".concat(p).concat(e.shortName);if(null!=e&&e.name)return"".concat(p).concat(e.name)}return null!==(r=U(e))&&void 0!==r&&null!==(t=r.meta)&&void 0!==t&&t.name?U(e).meta.name:null}function L(e){var r=U(e).family.owners.find((e=>"domain"===e.meta.op));return r?J(r):null}function Q(e){var r=function(e){var{meta:r}=e;return"config"in r?r.config.loc:r.loc}(U(e));if(r)return r}function U(e){return"graphite"in e?e.graphite:e}function W(e){return e&&e.meta||{}}function X(t){var{source:o,timeout:i,target:c=r({name:"target",sid:"-z2vw3w"},{name:"target",sid:"-z2vw3w"})}=t;if(!n.unit(o))throw new TypeError("source must be a unit from effector");if(!n.unit(c))throw new TypeError("target must be a unit from effector");var u=function(e){if(n.store(e,{sid:"-v8hs87"})||"function"==typeof e||"number"==typeof e)return e;throw new TypeError("'timeout' argument must be a function, Store, or a number. Passed \"".concat(typeof e,'"'))}(i),d=s((e=>{var{payload:r,milliseconds:n}=e;return new Promise((e=>{setTimeout(e,n,r)}))}),{name:"timerFx",sid:"-2uwk8k"});return a({and:[{source:e({and:[{milliseconds:u}],or:{name:"source",sid:"c4jhin"}}),clock:o,fn:(e,r)=>{var{milliseconds:n}=e;return{payload:r,milliseconds:"function"==typeof n?n(r):n}},target:d}],or:{sid:"-w88eue"}}),p({and:{from:d.doneData,to:c},or:{sid:"-vozm2r"}}),d.doneData}function Y(r,t,o){if(n.store(r,{sid:"ozzvoc"}))return e({and:[r,t,o,(e,r,n)=>e?r:n],or:{sid:"-5vau2h"}});var a=r;return Y(a.filter,a.then,a.other)}function Z(e){return e.map((e=>null===e))}function ee(r,n){return e({and:[r,n,(e,r)=>e===r],or:{sid:"-pqjlti"}})}function re(r,t){var o,a=[],i=()=>!1;Array.isArray(r)?(a=r,i=t):Array.isArray(r.stores)&&(a=r.stores,i=r.predicate),o="function"==typeof i?i:n.store(i,{sid:"sid3ut"})?i.map((e=>r=>e===r)):e=>e===i;var c=e({and:[a],or:{name:"$values",sid:"h09uhg"}});return e({and:[o,c,(e,r)=>r.every(e)],or:{sid:"hfkdw9"}})}function ne(r){for(var n=arguments.length,t=new Array(n>1?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];return e({and:[t,e=>r.reduce(((n,t,o)=>n.concat(oe(r,o)?t:"".concat(t).concat(te(e[o])))),"")],or:{sid:"-yrbthp"}})}function te(e){return Array.isArray(e)?e.map((e=>String(e))).join(", "):String(e)}function oe(e,r){return r===e.length-1}function ae(r){var{effects:n,domain:t}=r;if(t){var o=t.createStore(0,{name:"$inFlight",sid:"-y7vg7t"});return t.onCreateEffect((e=>{o.on(e,(e=>e+1)).on(e.finally,(e=>e-1))})),o}return e({and:[n.map((e=>e.inFlight)),e=>e.reduce(((e,r)=>e+r),0)],or:{sid:"ubqxa7"}})}function ie(e){var{timeout:t,start:c,stop:u,leading:s=!1,trailing:f=!1}=e,l=r({name:"tick",sid:"u782pl"}),m=o(!1,{name:"$isRunning",sid:"-xegewf"}),p=function(e){if(n.store(e,{sid:"7icamc"}))return e;if("number"==typeof e)return o(e,{and:{name:"$timeout"},sid:"knc3em"});throw new TypeError('timeout parameter in interval method should be number or Store. "'.concat(typeof e,'" was passed'))}(t),v=m.map((e=>!e)),g=r({name:"saveTimeout",sid:"ab3q7d"}),y=o(null,{name:"$timeoutId",sid:"-aj5rja"}).on(g,((e,r)=>{var{timeoutId:n}=r;return n})),h=o((()=>{}),{name:"$rejecter",sid:"opb0ih"}).on(g,((e,r)=>{var{reject:n}=r;return n})),b=d({and:{source:{timeout:p,running:m},effect:e=>{var{timeout:r,running:n}=e;return n?new Promise(((e,n)=>{var t=setTimeout(e,r);g({timeoutId:t,reject:n})})):Promise.reject()}},or:{name:"timeoutFx",sid:"9hil7b"}}),w=d({and:{source:{timeoutId:y,rejecter:h},effect:e=>{var{timeoutId:r,rejecter:n}=e;n(),r&&clearTimeout(r)}},or:{name:"cleanupFx",sid:"-v02m7d"}});if(i({and:[{clock:c,source:p,filter:v,target:b}],or:{sid:"-vop0ii"}}),s){var k=i({and:[{clock:c,filter:v}],or:{name:"onReady",sid:"-cmw7lh"}});a({and:[{clock:k,target:l}],or:{sid:"-v876ny"}})}return a({and:[{clock:c,fn:()=>!0,target:m}],or:{sid:"-v6jsxl"}}),i({and:[{clock:b.done,source:p,filter:m,target:b}],or:{sid:"-urpcwu"}}),i({and:[{clock:b.done,filter:m,target:l.prepend((()=>{}))}],or:{sid:"-ucb4aq"}}),u&&(f&&a({and:[{clock:u,target:l}],or:{sid:"6lcn0o"}}),m.on(u,(()=>!1)),a({and:[{clock:u,target:w}],or:{sid:"71ao6f"}})),{tick:l,isRunning:m}}function ce(e){return e.map((e=>!e))}function ue(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return e({and:[n,e=>{for(var r of e)if(r)return!0;return!1}],or:{sid:"-44722k"}})}var se={some:e=>e.some(Boolean),every:e=>e.every(Boolean)};function de(r){var{effects:t,domain:o,of:a="some"}=r;if(!n.domain(o,{sid:"97b92c"})&&!t)throw new TypeError("domain or effects should be passed");if("some"!==a&&"every"!==a)throw new TypeError('strategy parameter "of" can be "every" or "some". Passed: "'.concat(a,'"'));var i=null!=t?t:[],c=se[a];return o&&(i=[],o.onCreateEffect((e=>i.push(e)))),e({and:[i.map((e=>e.pending)),c],or:{sid:"a37bj0"}})}function fe(e){var{clock:n,target:t}=e,o=Array.isArray(t)?t:[t],a=Array.isArray(n)?n:[null!=n?n:r({name:"clocks",sid:"bqmea5"})];return o.forEach((e=>{e.reset(a)})),void 0===n?a[0]:void 0}function le(e){var{source:r,shape:n}=e,t={};for(var o in n)o in n&&function(){var e=n[o];t[o]=r.map((r=>{var n=e(r);return void 0===n?null:n}))}();return t}function me(e){var{source:r,clock:n,fn:t=(e=>e)}=e,i=t(r.defaultState),c=a(n?{and:[{source:r,clock:n,fn:t}],or:{name:"onSnapshot",sid:"-imuiws"}}:{and:[{source:r,fn:t}],or:{name:"onSnapshot",sid:"-imaqbf"}}),u=o(i,{name:"$snapshot",sid:"-63s6pn"});return u.on(c,((e,r)=>r)),u}function pe(r,t){var o,a=[],i=()=>!1;Array.isArray(r)?(a=r,i=t):Array.isArray(r.stores)&&(a=r.stores,i=r.predicate),o="function"==typeof i?i:n.store(i,{sid:"zbwu0l"})?i.map((e=>r=>e===r)):e=>e===i;var c=e({and:[a],or:{name:"$values",sid:"-lv5do0"}});return e({and:[o,c,(e,r)=>r.some(e)],or:{sid:"-efc5w7"}})}function ve(e){var{source:r,cases:t}=e,o={},a=n.store(r,{name:"current",sid:"-htjkz7"})?r.updates:r;for(var i in t)i in t&&function(){var e=t[i];o[i]=a.filterMap(e),a=a.filter({fn:r=>!e(r)})}();return o.__=a,o}var ge={}.hasOwnProperty;function ye(e){var{targets:n,source:t=r({name:"source",sid:"-fkbi3c"},{name:"source",sid:"-fkbi3c"})}=e,o=function(e){if(c=n,u=e,ge.call(c,u)){var r=n[e],o=i({and:[{source:t,greedy:!0,filter:r=>"object"==typeof r&&null!==r&&e in r}],or:{name:"hasTargetKey",sid:"-cov4g4"}});a({and:[{greedy:!0,clock:o,fn:r=>r[e],target:r}],or:{sid:"lpn34j"}})}var c,u};for(var c in n)o(c);return t}function he(e){var{effect:r,defaultValue:n="initial"}=e,t=o(n,{name:"$status",sid:"abrgim"});return t.on(r,(()=>"pending")).on(r.done,(()=>"done")).on(r.fail,(()=>"fail")),t}function be(e){var{source:t,timeout:c,target:u=r({name:"target",sid:"r328r6"},{name:"target",sid:"r328r6"})}=e;if(!n.unit(t))throw new TypeError("source must be unit from effector");var d=function(e){if(n.store(e,{sid:"-h0ap6r"}))return e;if("number"==typeof e){if(e<0||!Number.isFinite(e))throw new Error('timeout must be positive number or zero. Received: "'.concat(e,'"'));return o(e,{and:{name:"$timeout"},sid:"-h97n10"})}throw new TypeError('timeout parameter should be number or Store. "'.concat(typeof e,'" was passed'))}(c),f=s((e=>new Promise((r=>setTimeout(r,e)))),{name:"timerFx",sid:"-pyjx8k"}),l=o(null,{and:{serialize:"ignore"},name:"$payload",sid:"hinjft"}).on(t,((e,r)=>r)),m=r({name:"triggerTick",sid:"-sf8sou"}),p=o(!0,{and:{serialize:"ignore"},name:"$canTick",sid:"-m0cqc"}).on(m,(()=>!1)).on(u,(()=>!0));return i({and:[{clock:t,filter:p,target:m}],or:{sid:"-hzhj9b"}}),a({and:[{source:d,clock:m,target:f}],or:{sid:"-hkn38k"}}),a({and:[{source:l,clock:f.done,target:u}],or:{sid:"-hhcboe"}}),u}var we=()=>Date.now();function ke(e){var{clock:r,getNow:n,initial:t}=e,o=null!=n?n:we,a=s(o,{name:"readNowFx",sid:"53d7kp"}),i=v(a,null!=t?t:o(),{name:"$time",sid:"-xu6mk0"});return p({and:{from:r,to:a},or:{sid:"remzgl"}}),i}export{g as and,b as combineEvents,k as condition,O as debounce,z as debug,X as delay,Y as either,Z as empty,ee as equals,re as every,ne as format,ae as inFlight,ie as interval,ce as not,ue as or,de as pending,fe as reset,le as reshape,me as snapshot,pe as some,ve as splitMap,ye as spread,he as status,be as throttle,ke as time};
//# sourceMappingURL=patronum.js.map
